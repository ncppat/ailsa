<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å“å®šåƒ¹è¨ˆç®—å™¨</title>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .calculator { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0,0,0,0.1); width: 360px; }
        h2 { text-align: center; color: #333; margin-bottom: 20px; border-bottom: 2px solid #28a745; padding-bottom: 10px; }
        .form-group { margin-bottom: 18px; }
        label { display: block; margin-bottom: 6px; font-weight: bold; color: #444; }
        input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        .radio-group { display: flex; gap: 20px; margin-top: 5px; }
        button { width: 100%; padding: 14px; background-color: #007bff; color: white; border: none; border-radius: 6px; font-size: 18px; cursor: pointer; transition: 0.2s; font-weight: bold; }
        button:hover { background-color: #0056b3; }
        .result { margin-top: 25px; padding: 20px; background-color: #e2e6ea; border-radius: 8px; text-align: center; }
        .result p { margin: 8px 0; font-size: 15px; }
        .final-price { font-size: 32px; color: #dc3545; font-weight: bold; margin-top: 10px; }
        .note { font-size: 13px; color: #666; margin-top: 5px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="calculator">
    <h2>ğŸ“Š å•†å“å®šåƒ¹è¨ˆç®—å™¨</h2>

    <div class="form-group">
        <label for="cost">1. å•†å“æˆæœ¬åƒ¹ ($)</label>
        <input type="number" id="cost" placeholder="è¼¸å…¥æˆæœ¬é‡‘é¡">
    </div>

    <div class="form-group">
        <label>2. æ˜¯å¦å·²å«ç¨…ï¼Ÿ</label>
        <div class="radio-group">
            <label><input type="radio" name="tax" value="included" checked> å·²å«ç¨…</label>
            <label><input type="radio" name="tax" value="excluded"> æœªå«ç¨… (x1.05)</label>
        </div>
    </div>

    <div class="form-group">
        <label for="shipping">3. é‹è²» ($)</label>
        <input type="number" id="shipping" placeholder="è‹¥å·²å«é‹è«‹å¡« 0">
    </div>

    <div class="form-group">
        <label for="percent">4. æŠ½æˆ/åˆ©æ½¤ç™¾åˆ†æ¯” (%)</label>
        <input type="number" id="percent" placeholder="ä¾‹å¦‚æŠ½æˆæœ«å”®çš„20%å¡« 20">
        <div class="note">é‚è¼¯ï¼šæˆæœ¬ Ã· (100% - å¡«å¯«%) <br> å¡« 20 ä»£è¡¨å”®åƒ¹çš„ 20% æ˜¯æŠ½æˆ/åˆ©æ½¤</div>
    </div>

    <button onclick="calculatePrice()">è¨ˆç®—å”®åƒ¹</button>

    <div class="result" id="resultArea" style="display:none;">
        <p>ç¸½æˆæœ¬ (å«ç¨…+é‹)ï¼š<b id="baseCost">0</b></p>
        <p>å»ºè­°å”®åƒ¹ï¼š</p>
        <div class="final-price" id="finalPrice">0</div>
        <p style="font-size: 12px; color: #555;">(æ­¤å”®åƒ¹å«ç¨…å«é‹ï¼Œæ‰£é™¤ <span id="cutPercent"></span>% å¾Œæ˜¯æˆæœ¬åƒ¹)</p>
    </div>
</div>

<script>
    function calculatePrice() {
        // 1. ç²å–æˆæœ¬
        let cost = parseFloat(document.getElementById('cost').value);
        if (isNaN(cost)) { alert("è«‹è¼¸å…¥æˆæœ¬é‡‘é¡"); return; }
        
        // 2. åˆ¤æ–·ç¨…é¡
        let taxOption = document.querySelector('input[name="tax"]:checked').value;
        if (taxOption === 'excluded') {
            cost = cost * 1.05;
        }

        // 3. åŠ ä¸Šé‹è²»
        let shipping = parseFloat(document.getElementById('shipping').value);
        if (isNaN(shipping)) shipping = 0; 
        
        let totalBaseCost = cost + shipping;

        // 4. è¨ˆç®—é‚è¼¯ä¿®æ­£
        let percentInput = parseFloat(document.getElementById('percent').value);
        
        if (isNaN(percentInput)) {
            alert("è«‹è¼¸å…¥ç™¾åˆ†æ¯”");
            return;
        }
        if (percentInput >= 100) {
            alert("æŠ½æˆä¸èƒ½è¶…éæˆ–ç­‰æ–¼ 100%ï¼Œé€™æ¨£å”®åƒ¹æœƒè®Šæˆç„¡é™å¤§ï¼");
            return;
        }

        // ä¿®æ­£å¾Œçš„å…¬å¼ï¼šç¸½æˆæœ¬ / (1 - (ç™¾åˆ†æ¯”/100))
        // ä¾‹å¦‚ 20% -> ç¸½æˆæœ¬ / 0.8
        let divisor = 1 - (percentInput / 100);
        let finalPrice = totalBaseCost / divisor;

        // é¡¯ç¤ºçµæœ
        document.getElementById('baseCost').innerText = totalBaseCost.toFixed(2);
        document.getElementById('cutPercent').innerText = percentInput;
        document.getElementById('finalPrice').innerText = "$" + Math.ceil(finalPrice); 
        document.getElementById('resultArea').style.display = 'block';
    }
</script>

</body>
</html>
